!function(t){var e={_reset:function(e){var n=e;n.find("option").remove().end().append(t("<option>").val("").text(n.data("jsonselect").empty_text))},load:function(n){var a=n,s=null,o=a.data("params");s=t(a.data("parent")),s.length&&(o=t.extend(!0,{},o,{id:s.val()})),t.ajax({url:a.data("url"),dataType:"json",data:o,complete:function(){},success:function(e,n,s){t(e).map(function(){var e=this[a.data("value")],n=this[a.data("text")];n&&a.append(t("<option>").val(e).text(n))});t.isFunction(a.data("jsonselect").events.success)&&a.data("jsonselect").events.success.call(a,[e,n,s])},beforeSend:function(){e._reset(a)},error:function(e,n,s){t.isFunction(a.data("jsonselect").events.error)&&a.data("jsonselect").events.error.call(a,[e,n,s])}})}};t.fn.jsonselect=function(n){return this.length?(this.each(function(){var a=t(this);if(!a.is("select"))return t.error("Element "+a.attr("name")+" is not an select form control!"),this;if(n=t.extend({},t.fn.jsonselect.defaults,n),a.data("jsonselect",n),a.data("parent")){var s=t(a.data("parent"));s.bind("change",function(){e.load(a)})}a.data("autoload")&&e.load(a)}),this):this},t.fn.jsonselect.defaults={selected:null,empty_text:"Select an option",events:{success:null,error:null}}}(jQuery);