!function(t){var e={_reset:function(e){var a=e;a.find("option").remove().end().append(t("<option>").val("").text(a.data("jsonselect").empty_text))},load:function(a){var n=a,s=null,o=n.data("params");s=t(n.data("parent")),s.length&&(o=t.extend(!0,{},o,{id:s.val()})),t.ajax({url:n.data("url"),dataType:"json",data:o,success:function(a,s,o){e._reset(n);t(a).map(function(){var e=n.data("value"),a=n.data("text");n.append(t("<option>").val(this[e]).text(this[a]))});t.isFunction(n.data("jsonselect").events.success)&&n.data("jsonselect").events.success.call(n,[a,s,o])}})}};t.fn.jsonselect=function(a){return this.length?(this.each(function(){var n=t(this);if(!n.is("select"))return t.error("Element "+n.attr("name")+" is not an select form control!"),this;if(a=t.extend({},t.fn.jsonselect.defaults,a),n.data("jsonselect",a),n.data("parent")){var s=t(n.data("parent"));s.bind("change",function(){e.load(n)})}n.data("autoload")&&e.load(n)}),this):this},t.fn.jsonselect.defaults={selected:null,empty_text:"Select an option",events:{success:null}}}(jQuery);